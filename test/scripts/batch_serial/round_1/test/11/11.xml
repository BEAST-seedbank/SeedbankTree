<beast version='2.0' namespace='beast.base.evolution:beast.base.evolution.alignment:beast.pkgmgmt:beast.base.core:beast.base.inference:beast.pkgmgmt:beast.base.core:beast.base.inference.parameter:beast.base.evolution.tree:beast.base.evolution.tree.coalescent:beast.base.util:beast.base.math:beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:beast.base.evolution.substitutionmodel:beast.base.evolution.likelihood:beast.evolution.migrationmodel:beast.base.inference.distribution
:seedbanktree.evolution.tree:seedbanktree.evolution.branchratemodel:seedbanktree.distributions:seedbanktree.inference.distribution:seedbanktree.operators:seedbanktree.util'>
	<data id='alignment' dataType='nucleotide'>
    $$$REPLACE_SEQUENCES$$$
	</data>
	
	<!-- Trait data associated with sequences -->
	<typeTraitSet spec='TraitSet' id='typeTraitSet' traitname='type' 
		value='$$$REPLACE_TYPES$$$'>
		<taxa spec='TaxonSet' alignment='@alignment'/>
	</typeTraitSet>
	<timeTraitSet spec='TraitSet' id='timeTraitSet' traitname='date-backward' 
		value='$$$REPLACE_TIMES$$$'>
		<taxa spec='TaxonSet' alignment='@alignment'/>
	</timeTraitSet>

	<!-- Transition model -->
	<transitionModel spec='TransitionModel' id='transitionModel'>
		<c spec='RealParameter' id='c' value='1.0' lower='0.0'/>
		<K spec='RealParameter' id='K' value='10.0' lower='0.0'/>
		<theta spec='RealParameter' id='theta' value='1.0' />
	</transitionModel>
	
	<!-- Branch clock model -->
	<branchRateModel spec='SeedbankClockModel' id='branchRateModel'>
		<alpha spec='RealParameter' id='alpha' value='0.5' lower='0.0' upper='1.0'/>
		<tree idref='sbTree'/>
	</branchRateModel>
	
	<!-- Substitution model and site model -->
	<siteModel spec='SiteModel' id='siteModel'>
		<mutationRate spec='RealParameter' id='mutationRate' value='0.01' lower='0.0'/>
		<substModel spec='JukesCantor'/>
	</siteModel>
	
	<!-- Priors -->
	<distribution spec='SeedbankTreeDensity' id='seedbankTreeDensity' checkValidity='true'>
		<tree idref='sbTree'/>
		<transitionModel idref='transitionModel'/>
	</distribution>
		
	<distribution spec='CompoundDistribution' id='prior'>
		<distribution spec='Prior' id='cPrior' x='@c'>
			<distr spec='LogNormalDistributionModel' M='0' S='0.5'/>
		</distribution>
		
		<distribution spec='Prior' id='KPrior' x='@K'>
			<distr spec='LogNormalDistributionModel' M='2.5' S='0.5'/>
			<!-- <distr spec='LogNormalDistributionModel' M='2.5' S='0.5'/> -->
		</distribution>
		
		<distribution spec='Prior' id='thetaPrior' x='@theta'>
			<distr spec='LogNormalDistributionModel' M='0.0' S='1.0'/>
		</distribution>
		
		<distribution spec='Prior' id='alphaPrior' x='@alpha'>
			<!-- <distr spec='Beta' alpha='100' beta='99900'/> -->
			<!-- <distr spec='LogNormalDistributionModel' M='0.0' S='2.0'/> -->
			<!-- <distr spec='Normal' mean='0.1' sigma='0.1'/> -->
			<distr spec='distribution.Uniform' lower='0.0' upper='1.0'/>
		</distribution>
		
		<distribution spec='Prior' id='muPrior' x='@mutationRate'>
			<!-- <distr spec='LogNormalDistributionModel' M='0.0' S='2.0'/> -->
			<distr spec='Normal' mean='0.01' sigma='0.01'/>
		</distribution>
		
	</distribution>
	
	<!-- Likelihood -->
	<distribution spec='TreeLikelihood' id='treeLikelihood'>
		<data idref='alignment'/>
		<tree idref='sbTree'/>
		<siteModel idref='siteModel'/>
		<branchRateModel idref='branchRateModel'/>
	</distribution>
	
	<run spec='MCMC' id='mcmc' chainLength='100000000' storeEvery='50000'>
		<init spec='SeedbankTreeInitialiser'>
			<transitionModel idref='transitionModel'/>
			<initial idref='sbTree'/>
			<trait idref='typeTraitSet'/>
			<trait idref='timeTraitSet'/>
		</init>
		
		<!-- <init spec='SeedbankTreeFromNewick' 
		value='$$$REPLACE_NEWICK$$$'
		> 
			<initial idref='sbTree'/>
			<data idref='alignment'/>
		</init> -->
		
		<state>
			<stateNode spec='SeedbankTree' id='sbTree' trait='@typeTraitSet' estimate='true'/>
			<stateNode idref='c'/>
			<stateNode idref='K'/>
			<stateNode idref='theta'/>
			<stateNode idref='alpha'/>
			<stateNode idref='mutationRate'/>
		</state>
	
		<distribution spec='CompoundDistribution' id='posterior'>
			<distribution idref='prior'/>
			<distribution idref='treeLikelihood'/>
			<distribution idref='seedbankTreeDensity'/>
		</distribution>
		
		<operator spec='ScaleOperator' id='cScaler'
 	      	parameter='@c' scaleFactor='0.80' weight='1'>
     	</operator>
     	<operator spec='ScaleOperator' id='KScaler'
 	      	parameter='@K' scaleFactor='0.80' weight='1'>
     	</operator>
		<operator spec='ScaleOperator' id='thetaScaler'
	      	parameter='@theta' scaleFactor='0.80' weight='1'>
     	</operator>
     	<!-- <operator spec='ScaleOperator' id='alphaScaler'
 	      	parameter='@alpha' scaleFactor='0.80' weight='1'>
     	</operator>
     	<operator spec='ScaleOperator' id='muScaler'
 	      	parameter='@mutationRate' scaleFactor='0.80' weight='1'>
     	</operator> -->
     	<operator spec='SeedbankTreeScale' id='treeScale'
			sbTree="@sbTree" transitionModel='@transitionModel'
			scaleFactor="0.80" weight="1">
		</operator>
     	
		<operator spec='RecolorBranch' 
			sbTree='@sbTree' transitionModel='@transitionModel' weight='10'
		/>
     	
     <operator spec='TypedWilsonBalding' 
			sbTree='@sbTree' transitionModel='@transitionModel'
		  weight='10'
		/>
		<operator spec='TypedSubtreeExchange'
		  sbTree='@sbTree' transitionModel='@transitionModel' weight='10'
		  isNarrow='true'
		/>
		<operator spec='TypedSubtreeExchange'
		  sbTree='@sbTree' transitionModel='@transitionModel' weight='10'
		  isNarrow='false'
		/>
		<operator spec='NodeShiftRetype'
		  sbTree='@sbTree' transitionModel='@transitionModel' weight='10'
			rootOnly='true' rootScaleFactor='0.8'
		/>
		<operator spec='NodeShiftRetype'
		  sbTree='@sbTree' transitionModel='@transitionModel' weight='10'
			rootOnly='false'
		/>
		
		<logger id='screenlog' logEvery='50000'>
			<log idref='posterior'/>
            <log idref='treeLikelihood'/>
            <log idref='seedbankTreeDensity'/>
			<log idref='prior'/>
			<log idref='cPrior'/>
			<log idref='KPrior'/>
			<log idref='thetaPrior'/>
			<log idref='alphaPrior'/>
			<log idref='muPrior'/>
		</logger>
		
		<logger id='tracelog' fileName='$(filebase).log' logEvery='5000'>
			<log idref='posterior'/>
			<log idref='treeLikelihood'/>
			<log idref='seedbankTreeDensity'/>
			<log idref='prior'/>
			<log idref='cPrior'/>
			<log idref='KPrior'/>
			<log idref='thetaPrior'/>
			<log idref='alphaPrior'/>
			<log idref='muPrior'/>
			<log idref='c'/>
			<log idref='K'/>
			<log idref='theta'/>
			<log idref='alpha'/>
			<log idref='mutationRate'/>
			<log id='treeStatLogger' spec='TreeStatLogger' tree='@sbTree'/>
			<log id='dormantPercentage' spec='DormantPercentage' sbTree='@sbTree' logLengths='true'/>
			<log id='typeChangeCountsLogger' spec='TypeChangeCountsLogger' sbTree='@sbTree'/>
			<log id='nodeTypeCountsLogger' spec='NodeTypeCountsLogger' sbTree='@sbTree'/>
		</logger>
		
		<logger fileName='$(filebase).trees' logEvery='5000' id='treelog' mode='tree'>
			<log idref='sbTree'/>
		</logger>
	</run>

</beast>