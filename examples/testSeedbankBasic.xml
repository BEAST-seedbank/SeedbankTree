<beast version='2.0' namespace='beast.base.evolution.alignment:beast.pkgmgmt:beast.base.core:beast.base.inference:beast.pkgmgmt:beast.base.core:beast.base.inference.parameter:beast.base.evolution.tree:beast.base.evolution.tree.coalescent:beast.base.util:beast.base.math:beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:beast.base.evolution.substitutionmodel:beast.base.evolution.likelihood:beast.evolution.migrationmodel:beast.base.inference.distribution
:seedbanktree.evolution.tree:seedbanktree.evolution.branchratemodel:seedbanktree.distributions:seedbanktree.operators'>
	<!-- Four sequences each with 20 sites -->
	<data id='alignment' dataType='nucleotide'>
		<sequence taxon='sample0' value='TAAGAGGGGAGAGCTCTCAC'/>
		<sequence taxon='sample1' value='CTCGGAAGAGCGAGTCCCCC'/>
		<sequence taxon='sample2' value='CCCCGGTAGGACGCACCCGG'/>
		<sequence taxon='sample3' value='CCCTTATTGCCCGGGATCCA'/>
	</data>
	
	<!-- Trait data associated with sequences -->
	<typeTraitSet spec='TraitSet' id='typeTraitSet' traitname="type" 
	value='sample0=active, sample1=dormant, sample2=active, sample3=dormant'>
		<taxa spec='TaxonSet' alignment='@alignment'/>
	</typeTraitSet>
	<timeTraitSet spec='TraitSet' id='timeTraitSet' traitname="date-backward" 
	value='sample0=0, sample1=0, sample2=0, sample3=0'>
		<taxa spec='TaxonSet' alignment='@alignment'/>
	</timeTraitSet>
	
	<!-- Substitution model and site model -->
	<siteModel spec='SiteModel' id='siteModel'>
		<substModel spec='JukesCantor'/>
	</siteModel>
	
	<!-- Transition model -->
	<transitionModel spec='TransitionModel' id='transitionModel'>
		<transitionRate spec='RealParameter' id='transitionRate' value='1.0'/>
		<relativeSeedbankSize spec='RealParameter' id='relativeSeedbankSize' value='1.0'/>
		<activePopSize spec='RealParameter' id='activePopSize' value='5.0' estimate='false'/>
	</transitionModel>
	
	<!-- Branch clock model -->
	<branchRateModel spec='SeedbankClockModel' id='branchRateModel'>
		<dormantScaling spec='RealParameter' id='dormantScaling' value='0.5'/>
		<tree idref='sbTree'/>
	</branchRateModel>
	
	<!-- Priors -->
	<distribution spec='CompoundDistribution' id='prior'>
		<distribution spec='SeedbankTreeDensity'>
			<tree idref='sbTree'/>
			<transitionModel idref='transitionModel'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@transitionRate'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@relativeSeedbankSize'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@activePopSize'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@dormantScaling'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
	</distribution>
	
	<!-- Likelihood -->
	<distribution spec='TreeLikelihood' id='treeLikelihood'>
		<data idref='alignment'/>
		<tree idref='sbTree'/>
		<siteModel idref='siteModel'/>
		<branchRateModel idref='branchRateModel'/>
	</distribution>
	
	<run spec='MCMC' id='mcmc' chainLength='100' storeEvery='10'>
		<init spec="SeedbankTreeInitialiser">
			<transitionModel idref='transitionModel'/>
			<initial idref='sbTree'/>
			<trait idref='typeTraitSet'/>
			<trait idref='timeTraitSet'/>
		</init>
		
		<state>
			<stateNode spec='SeedbankTree' id='sbTree' trait='@typeTraitSet'/>
			<stateNode idref='transitionRate'/>
			<stateNode idref='relativeSeedbankSize'/>
			<stateNode idref='activePopSize'/>
			<stateNode idref='dormantScaling'/>
		</state>
	
		<distribution spec='CompoundDistribution' id='posterior'>
			<distribution idref='prior'/>
			<distribution idref='treeLikelihood'/>
		</distribution>
		
		<operator spec='ScaleOperator' id='transitionRateScaler'
 	      parameter='@transitionRate' scaleFactor='0.8' weight='1'>
     	</operator>
     	<operator spec='ScaleOperator' id='relativeSeedbankSizeScaler'
 	      parameter='@relativeSeedbankSize' scaleFactor='0.8' weight='1'>
     	</operator>
     	
     	<operator spec='SeedbankTreePairBirthDeath' id='treePBD'
 	      sbTree='@sbTree' transitionModel='@transitionModel' weight='1'>
     	</operator>
     	<operator spec='SeedbankTreeScale' id='treeScale'
 	      sbTree='@sbTree' transitionModel='@transitionModel' scaleFactor='0.8' weight='1'>
     	</operator>
		
		<logger id='screenlog' logEvery='1'>
			<log idref='posterior'/>
			<log idref='treeLikelihood'/>
		</logger>
		
		<logger fileName='examples/logs/testSeedbankBasic.trees' id='treelog' mode='tree'>
			<log idref='sbTree'/>
		</logger>
	</run>

</beast>