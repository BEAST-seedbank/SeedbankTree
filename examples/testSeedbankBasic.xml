<beast version='2.0' namespace='beast.base.evolution.alignment:beast.pkgmgmt:beast.base.core:beast.base.inference:beast.pkgmgmt:beast.base.core:beast.base.inference.parameter:beast.base.evolution.tree:beast.base.evolution.tree.coalescent:beast.base.util:beast.base.math:beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:beast.base.evolution.substitutionmodel:beast.base.evolution.likelihood:beast.evolution.migrationmodel:beast.base.inference.distribution
:seedbanktree.evolution.tree:seedbanktree.evolution.branchratemodel:seedbanktree.distributions:seedbanktree.operators'>
	<!-- Four sequences each with 20 sites -->
	<data id="alignment" dataType="nucleotide">
		<sequence taxon="sample0" value="TAAGAGGGGAGAGCTCTCAC"/>
		<sequence taxon="sample1" value="CTCGGAAGAGCGAGTCCCCC"/>
		<sequence taxon="sample2" value="CCCCGGTAGGACGCACCCGG"/>
		<sequence taxon="sample3" value="CCCTTATTGCCCGGGATCCA"/>
	</data>
	
	<!-- Trait data associated with sequences -->
	<typeTraitSet spec='TraitSet' id='typeTraitSet' traitname="type" 
	value="sample0=1, sample1=0, sample2=1, sample3=0">
		<taxa spec='TaxonSet' alignment='@alignment'/>
	</typeTraitSet>
	<timeTraitSet spec='TraitSet' id='timeTraitSet' traitname="date-backward" 
	value="sample0=0, sample1=0, sample2=0, sample3=0">
		<taxa spec='TaxonSet' alignment='@alignment'/>
	</timeTraitSet>
	
	<!-- Substitution model and site model -->
	<siteModel spec='siteModel' id='siteModel'>
		<substModel spec='JukesCantor'/>
	</siteModel>
	
	<!-- Transition model -->
	<transitionModel spec='TransitionModel' id='transitionModel'>
		<rate spec='RealParameter' id='transitionRate' value='1.0'/>
		<K spec='RealParameter' id='transitionK' value='1.0'/>
		<activeSize spec='RealParameter' id='transitionActiveSize' value='100.0'/>
	</transitionModel>
	
	<!-- Branch clock model -->
	<branchRateModel spec='SeedbankClockModel' id='branchRateModel'>
		<activeRate spec='RealParameter' id='activeRate' value='1.0' estimate='false'/>
		<dormantRate spec='RealParameter' id='dormantRate' value='0.5' estimate='false'/>
		<tree idref='sbTree'/>
	</branchRateModel>
	
	<!-- Priors -->
	<distribution spec='CompoundDistribution' id='prior'>
		<distribution spec='SeedbankTreeDensity'>
			<tree idref='sbtree'/>
			<transitionModel idref='transitionModel'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@transitionRate'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@transitionK'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@transitionActiveSize'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@activeRate'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
		
		<distribution spec='beast.base.inference.distribution.Prior' x='@dormantRate'>
			<distr spec='beast.base.inference.distribution.OneOnX'/>
		</distribution>
	</distribution>
	
	<!-- Likelihood -->
	<distribution spec='TreeLikelihood' id='treeLikelihood'>
		<data idref='alignment'/>
		<tree idref='sbtree'/>
		<siteModel idref='siteModel'/>
		<branchRateModel idref='branchRateModel'/>
	</distribution>
	
	<run spec='MCMC' id='mcmc' chainLength='1000' storeEvery='10'>
		<init spec="SeedbankTreeInitialiser">
			<transitionModel idref='transitionModel'/>
			<initial idref='sbTree'/>
			<trait idref='typeTraitSet'/>
			<trait idref='timeTraitSet'/>
		</init>
		
		<state>
			<stateNode spec='SeedbankTree' id='sbTree'/>
			<stateNode idref='transitionRate'/>
			<stateNode idref='transitionK'/>
			<stateNode idref='transitionActiveSize'/>
			<stateNode idref='activeRate'/>
			<stateNode idref='dormantRate'/>
		</state>
	
		<distribution spec='CompoundDistrbution' id='posterior'>
			<distribution idref='prior'/>
			<distribution idref='treeLikelihood'/>
		</distribution>
		
		<operator spec='ScaleOperator' id='tRateScaler'
 	      parameter='@transitionRate' scaleFactor='0.8' weight='1'>
     	</operator>
     	<operator spec='ScaleOperator' id='tKScaler'
 	      parameter='@transitionK' scaleFactor='0.8' weight='1'>
     	</operator>
     	<operator spec='ScaleOperator' id='tActiveSizeScaler'
 	      parameter='@transitionActiveSize' scaleFactor='0.8' weight='1' upper='1000'>
     	</operator>
     	
     	<operator spec='SeedbankTreeBeer' id='treeBeer'
 	      sbTree='@sbTree' transitionModel='@transitionModel'>
     	</operator>
     	<operator spec='SeedbankTreePairBirthDeath' id='treePBD'
 	      sbTree='@sbTree' transitionModel='@transitionModel'>
     	</operator>
     	<operator spec='SeedbankTreeScale' id='treePBD'
 	      sbTree='@sbTree' scaleFactor='0.8'>
     	</operator>
		
		<logger id='screenlog' logEvery='10'>
			<log idref='posterior'/>
			<log idref='treeLikelihood'/>
		</logger>
		
		<logger fileName='testSeedbankBasic.trees' id='treelog' mode='tree'>
			<log idref='sbTree'/>
		</logger>
	</run>
	
	
	
	
	
	
</beast>